
services:
  pocket-id:
    image: ghcr.io/pocket-id/pocket-id:v2.0.1
    container_name: pocket-id
    restart: unless-stopped

    env_file:
      - .env
    volumes:
      - /mnt/user/appdata/pocket-id:/data

    networks:
      - proxy_net

    labels:
     - traefik.enable=true
     - traefik.http.routers.pocketid.rule=Host(`id.theblaskies.com`)
     - traefik.http.routers.pocketid.entrypoints=websecure
     - traefik.http.routers.pocketid.tls=true
     - traefik.http.routers.pocketid.tls.certresolver=cloudflare
     - traefik.http.services.pocketid.loadbalancer.server.port=1411
     - traefik.http.routers.pocketid.priority=100

  # ðŸ”‘ REQUIRED FOR WEBAUTHN
     - traefik.http.middlewares.pocketid-headers.headers.customrequestheaders.X-Forwarded-Proto=https
     - traefik.http.middlewares.pocketid-headers.headers.customrequestheaders.X-Forwarded-Host=id.theblaskies.com
     - traefik.http.routers.pocketid.middlewares=pocketid-headers


networks:
  proxy_net:
    external: true
